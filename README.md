# Excel å…©è¡Œå­—ä¸²å·®ç•°åˆ†æžå·¥å…· (Python / Pandas)

## ç°¡ä»‹

é€™å€‹ Python ç¨‹å¼æ—¨åœ¨å¹«åŠ©ä½¿ç”¨è€…æ¯”è¼ƒ Excel å·¥ä½œè¡¨ä¸­**å…©æ¬„å­—ä¸²æ•¸æ“š**ä¹‹é–“çš„å·®ç•°ã€‚å®ƒæœƒé€è¡Œæ¯”è¼ƒæŒ‡å®šçš„å…©è¡Œæ–‡å­—å…§å®¹ï¼Œä¸¦ç²¾ç¢ºæ‰¾å‡ºæ‰€æœ‰ä¸ç›¸åŒã€å¤šé¤˜æˆ–ç¼ºå°‘çš„**å–®ä¸€å­—å…ƒ**ï¼Œå°‡é€™äº›ä¸åŒçš„å­—å…ƒé›†ä¸­åˆ—å‡ºåˆ°æ–°çš„æ¬„ä½ä¸­ã€‚

æœ¬å·¥å…·ç‰¹åˆ¥é©ç”¨æ–¼ï¼š

  * æ¯”å°æ–‡ä»¶ç‰ˆæœ¬ç•°å‹•ï¼ˆä¾‹å¦‚ï¼šæ­Œè©žã€ç¨‹å¼ç¢¼ç‰‡æ®µã€ç¿»è­¯æ–‡æœ¬ï¼‰ã€‚
  * å¿«é€Ÿè­˜åˆ¥è³‡æ–™æ¬„ä½ä¸­çš„ç´°å¾®å·®ç•°ï¼ˆä¾‹å¦‚ï¼šåç¨±ä¸­çš„éŒ¯åˆ¥å­—ï¼‰ã€‚

## ðŸ›  æŠ€è¡“è¦æ±‚

| å¥—ä»¶ | ç”¨é€” |
| :--- | :--- |
| `pandas` | è®€å–ã€è™•ç†å’Œå¯«å…¥ Excel æª”æ¡ˆã€‚ |
| `difflib` | Python å…§å»ºçš„åºåˆ—æ¯”è¼ƒå‡½å¼åº«ï¼Œç”¨æ–¼é€²è¡Œå­—ä¸²å·®ç•°æ¯”å°ã€‚ |
| `openpyxl` | Pandas ç”¨æ–¼è®€å¯« `.xlsx` æª”æ¡ˆæ ¼å¼æ™‚çš„ä¾è³´é …ã€‚ |

## ðŸ“¦ å®‰è£

åœ¨æ‚¨çš„ Python ç’°å¢ƒä¸­ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å®‰è£æ‰€éœ€å¥—ä»¶ï¼š

```bash
pip install pandas openpyxl
```

## ðŸš€ å¦‚ä½•ä½¿ç”¨

1.  **æº–å‚™æª”æ¡ˆï¼š**
    å°‡æ‚¨çš„ Excel æª”æ¡ˆï¼ˆ`.xlsx` æˆ– `.xls` æ ¼å¼ï¼‰èˆ‡ Python è…³æœ¬ï¼ˆ`excel_compare.py`ï¼‰æ”¾åœ¨åŒä¸€å€‹è³‡æ–™å¤¾ä¸­ã€‚

2.  **åŸ·è¡Œç¨‹å¼ï¼š**
    é–‹å•Ÿæ‚¨çš„å‘½ä»¤æç¤ºå­—å…ƒ (Command Prompt) æˆ–çµ‚ç«¯æ©Ÿï¼ŒåŸ·è¡Œï¼š

    ```bash
    python excel_compare.py
    ```

3.  **è¼¸å…¥åƒæ•¸ï¼š**
    ç¨‹å¼æœƒå¼•å°Žæ‚¨è¼¸å…¥ä»¥ä¸‹è³‡è¨Šï¼š

    | åƒæ•¸ | èªªæ˜Ž | ç¯„ä¾‹è¼¸å…¥ |
    | :--- | :--- | :--- |
    | Excel æª”æ¡ˆè·¯å¾‘ | æ‚¨çš„æª”æ¡ˆåç¨±ï¼ˆè‹¥æª”æ¡ˆåœ¨ç›¸åŒç›®éŒ„ï¼‰ã€‚ | `data.xlsx` |
    | å·¥ä½œè¡¨åç¨± | è¦é€²è¡Œæ¯”è¼ƒçš„ Excel å·¥ä½œè¡¨åç¨±ã€‚ | `Sheet1` æˆ– `åŽŸå§‹æ•¸æ“š` |
    | ç¬¬ä¸€è¡Œåç¨± | Excel ä¸­ç¬¬ä¸€æ¬„çš„æ¨™é¡Œåç¨±ï¼ˆ**è«‹è¼¸å…¥æ¨™é¡Œï¼Œè€Œéž Aã€B ç­‰æ¬„ä½å­—æ¯**ï¼‰ã€‚ | `åŽŸæ–‡` |
    | ç¬¬äºŒè¡Œåç¨± | Excel ä¸­ç¬¬äºŒæ¬„çš„æ¨™é¡Œåç¨±ã€‚ | `ä¿®æ”¹ç‰ˆ` |

    > **ðŸ’¡ æç¤ºï¼š** ç¨‹å¼æœƒè‡ªå‹•åŽ»é™¤æ‚¨è¼¸å…¥çš„æª”åå’Œæ¬„ä½åç¨±å‰å¾Œå¤šé¤˜çš„ç©ºæ ¼ã€‚

4.  **æª¢æŸ¥çµæžœï¼š**
    ç¨‹å¼åŸ·è¡Œå®Œæˆå¾Œï¼Œæœƒåœ¨ç›¸åŒè³‡æ–™å¤¾ç”Ÿæˆä¸€å€‹åç‚º **`å·®ç•°æ¯”å°çµæžœ.xlsx`** çš„æ–°æª”æ¡ˆã€‚

    æ–°æª”æ¡ˆå°‡æ–°å¢žä¸€å€‹åç‚º **`å·®ç•°å­—å…ƒ`** çš„æ¬„ä½ï¼Œåˆ—å‡ºè©²è¡Œå…©å­—ä¸²ä¸­æ‰€æœ‰ä¸åŒçš„å–®å€‹å­—å…ƒï¼Œä¸¦ç”¨é€—è™Ÿ ` ,  ` åˆ†éš”ã€‚

## âš ï¸ é™¤éŒ¯èˆ‡éŒ¯èª¤è™•ç†

å¦‚æžœç¨‹å¼å›žå ± **`éŒ¯èª¤: æ‰¾ä¸åˆ°æ‚¨æŒ‡å®šçš„æ¬„ä½åç¨±ã€‚`**ï¼Œè«‹ä»”ç´°æª¢æŸ¥ç¨‹å¼è¼¸å‡ºã€‚ç¨‹å¼æœƒè‡ªå‹•åˆ—å°å‡ºæª”æ¡ˆä¸­æ‰€æœ‰**æœ‰æ•ˆçš„æ¬„ä½æ¨™é¡Œ**ä¾›æ‚¨åƒè€ƒï¼Œè«‹ç¢ºä¿æ‚¨è¼¸å…¥çš„åç¨±èˆ‡åˆ—è¡¨ä¸­çš„æ¨™é¡Œå®Œå…¨åŒ¹é…ï¼ˆåŒ…æ‹¬å¤§å°å¯«ï¼‰ã€‚

```
!! éŒ¯èª¤: æ‰¾ä¸åˆ°æ‚¨æŒ‡å®šçš„æ¬„ä½åç¨±ã€‚
...
è«‹åƒè€ƒä»¥ä¸‹æ‰€æœ‰æœ‰æ•ˆçš„æ¬„ä½æ¨™é¡Œï¼Œä¸¦é‡æ–°åŸ·è¡Œç¨‹å¼ï¼š
-> 'æ­Œæ›²åç¨±'
-> 'æ­Œè©ž-åŽŸå§‹'   <-- è«‹è¼¸å…¥æ­¤æ¨™é¡Œ
-> 'æ­Œè©ž-ä¿®æ”¹'   <-- è«‹è¼¸å…¥æ­¤æ¨™é¡Œ
```

## æ ¸å¿ƒç¨‹å¼é‚è¼¯ (`find_string_differences` å‡½å¼)

æœ¬å·¥å…·çš„æ ¸å¿ƒé‚è¼¯æ˜¯ä½¿ç”¨ `difflib.SequenceMatcher` æ¯”è¼ƒå…©å€‹å­—ä¸²ï¼Œä¸¦é€šéŽåˆ†æžå…¶æ“ä½œç¢¼ï¼ˆ`replace`ã€`delete`ã€`insert`ï¼‰ä¾†è­˜åˆ¥ä¸¦æ“·å–å·®ç•°çš„å­—å…ƒï¼š

1.  **`replace`**ï¼šå…©å­—ä¸²ä¸­ç›¸å°æ‡‰ä½ç½®ä¸åŒçš„å­—å…ƒï¼Œå…©é‚Šçš„å­—å…ƒéƒ½æœƒè¢«æ”¶é›†ã€‚
2.  **`delete`**ï¼šåªå­˜åœ¨æ–¼ç¬¬ä¸€å€‹å­—ä¸²ä¸­çš„å­—å…ƒæœƒè¢«æ”¶é›†ã€‚
3.  **`insert`**ï¼šåªå­˜åœ¨æ–¼ç¬¬äºŒå€‹å­—ä¸²ä¸­çš„å­—å…ƒæœƒè¢«æ”¶é›†ã€‚

æœ€å¾Œï¼Œæ‰€æœ‰æ”¶é›†åˆ°çš„ä¸åŒå­—å…ƒæœƒé€éŽ `set()` é€²è¡Œ**åŽ»é‡**ï¼Œç¢ºä¿æ¯å€‹ä¸åŒçš„å­—å…ƒåªåˆ—å‡ºä¸€æ¬¡ã€‚
